<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Mishkah Mobile Demo</title>
    
    <!-- Dependencies -->
    <script src="https://ws.mas.com.eg/lib/mishkah.core.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Local Kit -->
    <script src="../lib/mobile-kit.js"></script>
</head>
<body class="bg-gray-100 text-gray-900 select-none touch-pan-y overflow-hidden h-screen w-full">
    <div id="app" class="h-full w-full"></div>

    <script>
        const D = Mishkah.DSL;
        const UI = AppKit.UI;

        // 1. Configuration
        const Config = {
            theme: 'light',
            lang: 'ar',
            homeView: 'home',
            data: { 
                counter: 0,
                showModal: false
            }
        };

        // 2. Orders
        const Orders = {
            'demo:inc': {
                on: ['click'],
                gkeys: ['demo:inc'],
                handler: (e, ctx) => {
                    ctx.setState(prev => {
                        const s = { ...prev };
                        s.data.counter++;
                        return s;
                    });
                }
            },
            'demo:open-modal': {
                on: ['click'], gkeys: ['demo:open-modal'],
                handler: (e, ctx) => {
                    ctx.setState(prev => ({ ...prev, env: { ...prev.env, modal: 'info' } }));
                }
            }
        };

        // 3. Views
        const Views = {
            home: (db) => UI.Shell({
                header: UI.Header({ 
                    title: 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 
                    actions: [
                        D.Button({ attrs: { gkey: 'app:toggle-theme', class: 'text-xl' } }, ['ğŸŒ“'])
                    ]
                }),
                nav: UI.NavBar({
                    activeId: 'home',
                    items: [
                        { id: 'home', icon: 'ğŸ ', label: 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', to: 'home' },
                        { id: 'settings', icon: 'âš™ï¸', label: 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', to: 'settings' }
                    ]
                })
            }, [
                // Content
                D.Div({ attrs: { class: 'p-4 space-y-4' } }, [
                    
                    // Welcome Card
                    UI.Card({ class: 'bg-gradient-to-br from-indigo-500 to-purple-600 text-white' }, [
                        D.H2({ attrs: { class: 'text-2xl font-bold mb-2' } }, ['Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ğŸ‘‹']),
                        D.P({ attrs: { class: 'opacity-90' } }, ['ØªØ·Ø¨ÙŠÙ‚ ØªØ¬Ø±ÙŠØ¨ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Mishkah Mobile Kit'])
                    ]),

                    // Counter Demo
                    UI.Card({}, [
                        D.Div({ attrs: { class: 'flex justify-between items-center' } }, [
                            D.Span({ attrs: { class: 'text-lg font-medium' } }, ['Ø§Ù„Ø¹Ø¯Ø§Ø¯: ' + db.data.counter]),
                            D.Button({ 
                                attrs: { 
                                    gkey: 'demo:inc',
                                    class: 'bg-[var(--primary)] text-white px-4 py-2 rounded-lg active:scale-95 transition-transform'
                                } 
                            }, ['Ø²ÙŠØ§Ø¯Ø© +'])
                        ])
                    ]),

                    // List Demo
                    UI.Card({ class: '!p-0 overflow-hidden' }, [
                        UI.ListItem({ title: 'Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚', subtitle: 'v1.0.0', icon: 'ğŸ“±', gkey: 'demo:open-modal' }),
                        UI.ListItem({ title: 'Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª', subtitle: 'Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…Ø¹Ø·Ù„', icon: 'ğŸ””' }),
                        UI.ListItem({ title: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬', icon: 'ğŸšª', class: 'text-red-500' })
                    ])
                ]),
                
                // Modals
                UI.Modal({ 
                    open: db.env.modal === 'info', 
                    title: 'Ø­ÙˆÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚',
                    onClose: 'modal:close'
                }, [
                    D.P({ attrs: { class: 'text-gray-600 leading-relaxed' } }, [
                        'Ù‡Ø°Ø§ ØªØ·Ø¨ÙŠÙ‚ ØªØ¬Ø±ÙŠØ¨ÙŠ ÙŠÙˆØ¶Ø­ Ø¥Ù…ÙƒØ§Ù†ÙŠØ§Øª AppKit ÙÙŠ Ø¨Ù†Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø§Øª ØªØ´Ø¨Ù‡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø£ØµÙ„ÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„ÙˆÙŠØ¨ Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ©.'
                    ])
                ])
            ]),

            settings: (db) => UI.Shell({
                header: UI.Header({ title: 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', back: true }),
                nav: UI.NavBar({
                    activeId: 'settings',
                    items: [
                        { id: 'home', icon: 'ğŸ ', label: 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', to: 'home' },
                        { id: 'settings', icon: 'âš™ï¸', label: 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', to: 'settings' }
                    ]
                })
            }, [
                D.Div({ attrs: { class: 'p-4' } }, [
                    UI.Card({ class: '!p-0 overflow-hidden' }, [
                        UI.ListItem({ 
                            title: 'Ø§Ù„Ù„ØºØ©', 
                            subtitle: db.env.lang === 'ar' ? 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©' : 'English', 
                            icon: 'ğŸŒ',
                            gkey: 'app:toggle-lang'
                        }),
                        UI.ListItem({ 
                            title: 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ', 
                            subtitle: db.env.theme === 'dark' ? 'Ù…ÙØ¹Ù„' : 'Ù…Ø¹Ø·Ù„', 
                            icon: 'ğŸŒ™',
                            gkey: 'app:toggle-theme'
                        })
                    ])
                ])
            ])
        };

        // 4. Body Router
        function Body(db) {
            const view = db.env.view || 'home';
            return Views[view] ? Views[view](db) : Views['home'](db);
        }

        // 5. Launch
        AppKit.create({
            ...Config,
            body: Body,
            orders: Orders,
            mount: '#app'
        });

    </script>
</body>
</html>
